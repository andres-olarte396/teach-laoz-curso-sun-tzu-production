<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Simulaci칩n M3: Chaos Engineering</title>
    <style>
        body { background: #000; color: #0f0; font-family: 'Courier New', monospace; text-align: center; }
        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; width: 60%; margin: 20px auto; }
        .server { border: 1px solid #0f0; padding: 20px; cursor: pointer; transition: all 0.3s; }
        .server.dead { background: #f00; border-color: #f00; color: #fff; transform: scale(0.9); }
        .server.recovered { background: #00f; border-color: #00f; color: #fff; }
        #status { font-size: 24px; margin: 20px; border: 1px solid #fff; padding: 10px; }
        button { background: #f00; color: #fff; border: 2px solid #fff; padding: 10px 20px; font-size: 18px; cursor: pointer; font-family: inherit; margin: 5px; }
        button.heal { background: #00f; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <h1>M칩dulo 3: La Consola del Caos</h1>
    <div id="status">SISTEMA ESTABLE. UPTIME: 100%</div>
    
    <div class="controls">
        <label><input type="checkbox" id="resilience"> Activar Auto-Scaling (Resiliencia)</label>
    </div>
    
    <button onclick="chaosMonkey()">游 SOLTAR CHAOS MONKEY</button>
    <button class="heal hidden" onclick="reset()">REINICIAR SIMULACI칍N</button>

    <div class="grid" id="grid">
        <!-- Servers generated by JS -->
    </div>

    <script>
        const grid = document.getElementById('grid');
        for(let i=0; i<10; i++) {
            let s = document.createElement('div');
            s.className = 'server';
            s.innerText = 'SRV-' + (i+1);
            s.id = 'srv-'+i;
            grid.appendChild(s);
        }

        function chaosMonkey() {
            const victimId = Math.floor(Math.random() * 10);
            const server = document.getElementById('srv-' + victimId);
            const isResilient = document.getElementById('resilience').checked;
            const status = document.getElementById('status');

            if (server.classList.contains('dead')) return; // Ya est치 muerto

            // KILL
            server.classList.add('dead');
            server.innerText = 'DEAD';
            
            if (isResilient) {
                status.innerText = "ALERTA: SRV-" + (victimId+1) + " CA칈DO. INICIANDO RECUPERACI칍N AUTOM츼TICA...";
                status.style.color = "yellow";
                
                setTimeout(() => {
                    server.className = 'server recovered';
                    server.innerText = 'SRV-' + (victimId+1) + ' (NEW)';
                    status.innerText = "RECUPERACI칍N EXITOSA. SISTEMA ESTABLE.";
                    status.style.color = "#0f0";
                }, 1500); // 1.5s recovery time
            } else {
                status.innerText = "ERROR CR칈TICO: SRV-" + (victimId+1) + " PERDIDO. CASCADA DE FALLOS INMINENTE.";
                status.style.color = "red";
                // Cascade failure simplistic simulation
                setTimeout(() => {
                    document.querySelectorAll('.server').forEach(s => s.classList.add('dead'));
                    status.innerText = "SISTEMA CA칈DO. GAME OVER. (Activa la resiliencia la pr칩xima vez)";
                    document.querySelector('.heal').classList.remove('hidden');
                }, 1000);
            }
        }

        function reset() {
            document.querySelectorAll('.server').forEach((s, i) => {
                s.className = 'server';
                s.innerText = 'SRV-' + (i+1);
            });
            document.getElementById('status').innerText = "SISTEMA ESTABLE.";
            document.getElementById('status').style.color = "#0f0";
            document.querySelector('.heal').classList.add('hidden');
        }
    </script>
</body>
</html>
